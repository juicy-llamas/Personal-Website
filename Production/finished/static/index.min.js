"use strict";function perror(e){console.error(e);var t=document.createElement("p");document.getElementsByClassName("content")[0].remove(),t.innerHTML=e+"<br />:(",t.style.margin="24px",document.body.append(t),gg=1}try{eval('"use strict"; let foo = () => true;')}catch{throw perror("Your browser doesn't support ES6"),new Error("ES6 is required")}Math.clamp=(e,t,r)=>t<e?t:e<r?r:e;const _tfind=(t,r)=>{for(let e=0;e<t.length;e++)if(r(t.item(e),e))return t.item(e)},_tany=(t,r)=>{for(let e=0;e<t.length;e++)if(r(t.item(e),e))return!0;return!1},fn=async function(){const k=document.getElementById("screen"),H=k.getContext("webgl2"),R=document.getElementById("image");var e=e=>null==e;{var t=document.getElementById("chrome-notice");let e=window.navigator.userAgent.toLowerCase();e=0<=e.indexOf("mobile")||0<=e.indexOf("phone")||0<=e.indexOf("ios")||0<=e.indexOf("andrioid");var r=void 0!==window.chrome&&null!==window.chrome||-1!==window.navigator.userAgent.indexOf("Chrome");e&&(t.innerHTML="Brush or drag your finger across the screen."+(r?"":" "+t.innerHTML)),r&&!e&&(t.style.display="none")}r=e=>{console.error(e);var t=document.createElement("p");throw document.getElementsByClassName("content")[0].remove(),t.innerHTML=e+"<br \\>:(",t.style.margin="24px",document.body.append(t),new Error("Something went wrong--see page")};e(k)&&r("Your browser does not support canvas."),(e(H)||e(H.viewport))&&r("Your browser does not suppport WebGL2 (WebGL1 won't work)."),e(R)&&r("Problem loading image.");const E=e=>{switch(e){case H.NO_ERROR:return"WebGL: NO_ERROR (were you expecting one?)";case H.INVALID_ENUM:return"WebGL: INVALID_ENUM";case H.INVALID_VALUE:return"WebGL: INVALID_VALUE";case H.INVALID_OPERATION:return"WebGL: INVALID_OPERATION";case H.INVALID_FRAMEBUFFER_OPERATION:return"WebGL: INVALID_FRAMEBUFFER_OPERATION";case H.OUT_OF_MEMORY:return"WebGL: OUT_OF_MEMORY";case H.CONTEXT_LOST_WEBGL:return"WebGL: CONTEXT_LOST_WEBGL";default:return"WebGL threw an undefined error!"}};H.getErrorStr=()=>E(H.getError()),k.width=window.innerWidth,k.height=window.innerHeight;let W=k.width/2,q=k.height/2,i=0,z=0,j=-1,J=-1,a=null,o=null;H.viewport(0,0,k.width,k.height),H.clearColor(0,0,0,0),H.clearDepth(1),H.enable(H.BLEND),H.disable(H.DEPTH_TEST),H.blendFunc(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA);const n=(e,t)=>{var r=H.createShader(t);if(H.shaderSource(r,e),H.compileShader(r),H.getShaderParameter(r,H.COMPILE_STATUS))return r;e=t===H.VERTEX_SHADER?"vertex shader":t===H.FRAGMENT_SHADER?"fragment shader":"undefined shader";console.error("a(n) "+e+" shader did not compile: "+H.getShaderInfoLog(r))},K=(e,t)=>{var r=H.createProgram(),e=n(e,H.VERTEX_SHADER),t=n(t,H.FRAGMENT_SHADER);return H.attachShader(r,e),H.attachShader(r,t),H.linkProgram(r),r},Q={fb1:H.createFramebuffer(),tx1:H.createTexture(),fb2:H.createFramebuffer(),tx2:H.createTexture()},m=new function(){let n=!1;const o=K(`
			attribute float vertexNum;
			
			#define TUPI radians( 360. )
			
			attribute vec2 Acenter;
			attribute vec2 AR;
			attribute float Aang1;
			attribute float Aang2;
			attribute vec4 Acolor;
			
			varying vec2 Vcenter;
			varying vec2 VR;
			varying float Vang1;
			varying float Vang2;
			varying vec4 Vcolor;
			
			uniform vec2 Uresolution;
			
			void main () {
				vec2 mask = vec2( sign( ( vertexNum - 1.5 ) / 2.0 ), sign( ( mod( vertexNum, 2.0 ) - 0.5 ) ) );
				vec2 cen = ( Acenter - Uresolution / 2. );
				float scaling = 1. + 2.0 / ( 1. + pow( 1.005, max( min( Uresolution.x - 100., Uresolution.y - 100. ), 0. ) ) );
				vec2 pos = ( AR.x * scaling * mask + cen ) / Uresolution * 2.;

				gl_Position = vec4( pos, 0., 1. );
				
				Vcenter = Acenter;
				VR = AR;
				Vang1 = Aang1;
				Vang2 = Aang2;
				Vcolor = Acolor;
			}
		`,`
			#ifdef GL_OES_standard_derivatives
			#extension GL_OES_standard_derivatives : enable
			#endif

			#define PI radians( 180. )
			#define TUPI radians( 360. )

			#ifdef GL_FRAGMENT_PRECISION_HIGH
				precision highp float;
			#else
				precision mediump float;
			#endif

			varying vec2 Vcenter;
			varying vec2 VR;
			varying float Vang1;
			varying float Vang2;
			varying vec4 Vcolor;

			void main () {
				vec2 diff = gl_FragCoord.xy - Vcenter;
				float alpha = 0.;
//				There was an issue with the squares overflowing the float val, so I had to change to highp.
// 				But, highp is not universally supported, so I can fall back to mediump 
				#ifndef GL_FRAGMENT_PRECISION_HIGH
					vec2 R2 = VR;
					vec2 dist = vec2( dot( diff / VR.x, diff ), dot( diff / VR.y, diff ) );
				#else
					vec2 R2 = VR * VR;
					float dotp = dot( diff, diff );
					vec2 dist = vec2( dotp, dotp );
				#endif
				
				#ifdef GL_OES_standard_derivatives
				float delta = fwidth( dist );
				delta = delta < 1. ? 1. : delta;
				#else
				float delta = 2. * VR.x;
				#endif

//				With the altdelta was too big, so I 4th rooted it.
				#ifndef GL_FRAGMENT_PRECISION_HIGH
					delta = pow( delta, 1./4. );
				#endif

//				Fixed hole-in-the-circle problem, may make this better later.
				if ( dist.x < R2.x - delta && R2.y == 0. ) {
					alpha = 1.;
				} else {
					/*
						CHANGE THIS WAY OF DOING THINGS!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! 
						YOU CAN DO THIS WITH MATRIX MATH.
					*/
					float theta = atan( -diff.y, -diff.x ) + PI;

					float deltaT = 0.015;
					alpha = 1.0 - smoothstep( R2.x - delta, R2.x + delta, dist.x )
								- smoothstep( R2.y + delta, R2.y - delta, dist.y );

					if ( Vang2 < TUPI ) {
						if ( Vang2 > Vang1 ) {
							alpha = alpha - smoothstep( Vang1 + deltaT, Vang1 - deltaT, theta )
										  - smoothstep( Vang2 - deltaT, Vang2 + deltaT, theta );
						} else {
							if ( theta > Vang2 + deltaT ) {
								alpha = alpha - smoothstep( Vang1 + deltaT, Vang1 - deltaT, theta );
							} else {
								alpha = alpha - smoothstep( Vang2 - deltaT, Vang2 + deltaT, theta );
							}
						}
					}
					
					alpha = clamp( alpha, 0., 1. );

					// if ( alpha == 0. )
					// 	discard;
				}
				
				gl_FragColor = vec4( Vcolor.rgb, Vcolor.a * alpha );
			}
		`),i=(H.useProgram(o),H.getAttribLocation(o,"vertexNum")),a=H.getAttribLocation(o,"Acenter"),s=H.getAttribLocation(o,"AR"),c=H.getAttribLocation(o,"Aang1"),l=H.getAttribLocation(o,"Aang2"),h=H.getAttribLocation(o,"Acolor"),d=H.getUniformLocation(o,"Uresolution"),u=(H.uniform2f(d,k.width,k.height),H.createBuffer()),f=(H.bindBuffer(H.ARRAY_BUFFER,u),H.bufferData(H.ARRAY_BUFFER,new Float32Array([0,1,2,3]),H.STATIC_DRAW),6),A=.2,R=8,E=0,m=.01,g=10,T=9,b=.66,v=.086;let _=[];this.circles=[];const F=[.745,.96,.976,.8],x=[.745,.96,.976,.8],t=(e,t,r,i,a,o)=>{this.circles.push(e),this.circles.push(t),this.circles.push(i),this.circles.push(r),this.circles.push(r),this.circles.push(0),this.circles.push(i),this.circles.push(!1);var i=document.getElementById("circ"+o),o=(this.circles.push(i),i.style.left=e-i.clientWidth/2+"px",i.style.top=k.height-t-i.clientHeight/2+"px",a+Math.PI>2*Math.PI?a-Math.PI:a+Math.PI),i=a+1.7*Math.PI>2*Math.PI?a-.3*Math.PI:a+1.7*Math.PI,n=a+.7*Math.PI>2*Math.PI?a-1.3*Math.PI:a+.7*Math.PI;_=[..._,e,t,r*b,0,0,2*Math.PI+.001,...F,e,t,r,r*(1-v),o,i,...x,e,t,r,r*(1-v),a,n,...x]};const S=(e,t)=>{var r=this.circles[e*T+0],i=this.circles[e*T+1],a=this.circles[e*T+2];let o=this.circles[e*T+3];var n=this.circles[e*T+4];let s=this.circles[e*T+5],c=this.circles[e*T+6];var l=this.circles[e*T+7],n=n===1/0||NaN===n?w:n,n=(c=c===1/0||NaN===c?A:c,a=a===1/0||NaN===a?A:a,s=s===1/0||NaN===s?0:s,n-(o=(o=o===1/0||NaN===o?w:o)>t?t:o)),t=Math.clamp(1+.0124*Math.abs(n)-.24*Math.max(Math.abs(s)-.36,0),.986,.02);s=s*t+.022*n*z,o+=s*z,!0===l&&o<=0&&(s=0,o=0);let h=.05;switch(c){case A:h=.04;break;case R:h=.108;break;case E:h=.04}(a+=h*(c-a)*z)>=c-m&&c===R&&(c=E),_[e*g*3+0]=r,_[e*g*3+g]=r,_[e*g*3+2*g]=r,_[e*g*3+1]=i,_[e*g*3+g+1]=i,_[e*g*3+2*g+1]=i,_[e*g*3+2]=o*b,_[e*g*3+g+2]=o,_[e*g*3+g+3]=o*(1-v),_[e*g*3+2*g+2]=o,_[e*g*3+2*g+3]=o*(1-v),this.circles[e*T+5]=s,this.circles[e*T+3]=o,this.circles[e*T+2]=a,this.circles[e*T+6]=c;t=_[3*g*e+g+4],n=_[3*g*e+g+5],l=_[3*g*e+2*g+4],r=_[3*g*e+2*g+5],i=a*z/(125/3);_[3*g*e+g+4]=t+i>=2*Math.PI?t+i-2*Math.PI:t+i,_[3*g*e+g+5]=n+i>=2*Math.PI?n+i-2*Math.PI:n+i,_[3*g*e+2*g+4]=l+i>=2*Math.PI?l+i-2*Math.PI:l+i,_[3*g*e+2*g+5]=r+i>=2*Math.PI?r+i-2*Math.PI:r+i};(k.width<960||k.height<540)&&console.warn("To developer: Rendering circles on small a screen--are you sure you want to do this?");let w=0,p=0,I=0,y=0,B=0;const U=()=>{var e=document.getElementById("chrome-notice"),t=document.getElementsByClassName("site-header")[0],e="none"==e.style.display?0:e.clientHeight+64,t=t.clientHeight;return 1024<k.width?Math.max(e,t):e+t},L=()=>{var e=k.height-U(),t=Math.max(k.width,e),e=Math.min(k.width,e);w=Math.sqrt(t*e/(f*f)/2),p=1.1*w,I=1.9*p,y=1.4*p,B=1.3*I,document.querySelector(":root").style.setProperty("--crc-txt-sz",2*w+"px")};L();var M;{var r=32;let i=[],a=50000001;this.circles=[];const G=k.height-U();W,G;for(let e=0;e<r;e++){let h=[],r=0,e=0,t=0;k.width<k.height?(e=Math.random()*(k.width-2*y)+y,M=Math.random(),t=.5<M?y:G-y):(t=Math.random()*(G-2*y)+y,M=Math.random(),e=.5<M?y:k.width-y),h[0]=e,h[1]=t;for(let l=1;l<f;l++){var D,P=2*Math.random()*Math.PI;let o=h[2*l-2]+B*Math.cos(P),n=h[2*l-1]+B*Math.sin(P),e=o,s=n,c=5e7/f;var N=()=>{var t=e=>0<e?e:0;let r=t(y-o)+t(o-(k.width-y))+t(y-n)+t(n-(G-y));r*=2*r;for(let e=0;e<=l;e++){var i=o-h[2*e],a=n-h[2*e+1],i=i*i+a*a;r+=t(I*I-i)}return 0<r&&(r<c&&(e=o,s=n,c=r),!0)};let t=36;for(;N()&&0<t;)P=2*Math.random()*Math.PI,D=B*(.8+.2*Math.random()),o=h[2*l-2]+D*Math.cos(P),n=h[2*l-1]+D*Math.sin(P),--t;N()&&(o=e,n=s),h[2*l]=o,h[2*l+1]=n,r+=c}r<a&&(a=r,i=h,console.log("best_err: "+a))}for(let e=0;e<f;e++){var C=Math.random()*Math.PI*2;t(i[2*e],i[2*e+1],w,A,C,e+1)}}const X=(t,r,i)=>{var a=k.height-U(),o=e=>(0<e)*e;const n=[];let s=.25;for(let e=0;e<f;e++)this.circles[e*T+0]*=r,this.circles[e*T+1]*=i;for(let e=0;e<t;e++){for(let r=0;r<f;r++){n[2*r+0]=0,n[2*r+1]=0;const h=this.circles[r*T+0],d=this.circles[r*T+1];var c=e=>{var t=h-this.circles[e*T+0],e=d-this.circles[e*T+1];t*t+e*e<B*I&&(n[2*r+0]+=t,n[2*r+1]+=e)};for(let e=0;e<r;e++)c(e);for(let e=r+1;e<f;e++)c(e);n[2*r+0]+=2*(o(y-h)-o(h-(k.width-y))),n[2*r+1]+=2*(o(y-d)-o(d-(a-y))),this.circles[r*T+0]+=n[2*r+0]*s,this.circles[r*T+1]+=n[2*r+1]*s}s/=1.02}for(let e=0;e<f;e++){var l=this.circles[e*T+8];l.style.left=this.circles[e*T+0]-l.clientWidth/2+"px",l.style.top=k.height-this.circles[e*T+1]-l.clientHeight/2+"px"}},V=H.createBuffer();H.bindBuffer(H.ARRAY_BUFFER,V),H.bufferData(H.ARRAY_BUFFER,new Float32Array(_),H.STATIC_DRAW);this.update=()=>{H.useProgram(o);for(var e=k.width+k.height,t=0;t<f;t++)S(t,e);H.bindBuffer(H.ARRAY_BUFFER,V);var r=new Float32Array(_);H.bufferSubData(H.ARRAY_BUFFER,0,r,0,Math.round(3*f*g)),H.enableVertexAttribArray(i),H.enableVertexAttribArray(a),H.enableVertexAttribArray(s),H.enableVertexAttribArray(c),H.enableVertexAttribArray(l),H.enableVertexAttribArray(h),H.bindBuffer(H.ARRAY_BUFFER,u),H.vertexAttribPointer(i,1,H.FLOAT,!1,0,0),H.bindBuffer(H.ARRAY_BUFFER,V),H.vertexAttribPointer(a,2,H.FLOAT,!1,40,0),H.vertexAttribPointer(s,2,H.FLOAT,!1,40,8),H.vertexAttribPointer(c,1,H.FLOAT,!1,40,16),H.vertexAttribPointer(l,1,H.FLOAT,!1,40,20),H.vertexAttribPointer(h,4,H.FLOAT,!1,40,24),H.vertexAttribDivisor(a,1),H.vertexAttribDivisor(s,1),H.vertexAttribDivisor(c,1),H.vertexAttribDivisor(l,1),H.vertexAttribDivisor(h,1),H.bindFramebuffer(H.FRAMEBUFFER,Q.fb1),H.drawArraysInstanced(H.TRIANGLE_STRIP,0,4,3*f),H.bindFramebuffer(H.FRAMEBUFFER,null),H.disableVertexAttribArray(i),H.disableVertexAttribArray(a),H.disableVertexAttribArray(s),H.disableVertexAttribArray(c),H.disableVertexAttribArray(l),H.disableVertexAttribArray(h)};let O=!(this.mousemove=(t,r)=>{if(!1===n)for(let e=0;e<f;e++){var i=this.circles[e*T+0],a=this.circles[e*T+1],o=this.circles[e*T+3],i=t-i,a=r-a;i*i+a*a<=o*o?(this.circles[e*T+4]=p,this.circles[e*T+6]!=E&&(this.circles[e*T+6]=R)):(this.circles[e*T+4]=w,this.circles[e*T+6]=A)}});this.resize=(e,t,r=10)=>{H.useProgram(o),H.uniform2f(d,k.width,k.height),L(),this.mousemove((j+1)*W,-(J-1)*q);const i=k.width/e,a=k.height/t;clearTimeout(O),O=setTimeout(()=>X(r,i,a),60)},this.reset=t=>{if(console.log("reset"),!1===n)for(let e=0;e<f;e++)this.circles[e*T+4]=w,this.circles[e*T+6]=A,!(this.circles[e*T+7]=!1)===t&&(this.circles[e*T+5]=0,this.circles[e*T+2]=A,this.circles[e*T+3]=w);else this.circles[n*T+3]=this.circles[n*T+4],this.circles[n*T+5]=0};const Y=e=>{for(let r=0;r<f;r++){const i=this.circles[r*T+0],a=this.circles[r*T+1];r===e?setTimeout(()=>{var e=k.width+Math.abs(i-W),t=k.height+Math.abs(a-q);this.circles[r*T+4]=1.1*Math.sqrt(e*e+t*t),this.circles[r*T+6]=0},500):setTimeout(()=>{this.circles[r*T+4]=0,this.circles[r*T+6]=0,this.circles[r*T+7]=!0},200)}n=e};this.click=(t,r)=>{!1!==n&&console.error("circles.click should not be called when a circle is already selected.");for(let e=0;e<f;e++){var i=this.circles[e*T+0],a=this.circles[e*T+1],o=this.circles[e*T+3],i=t-i,a=r-a;if(i*i+a*a<=o*o)return Y(e),e}return-1},this.deselect=e=>{this.circles[e*T+4]=w,this.circles[e*T+6]=A,this.circles[e*T+7]=!1,setTimeout(()=>{n=!1,this.mousemove((j+1)*W,-(J-1)*q)},600)}},s=new function(){const r=K(`
			attribute vec2 Apos;
			attribute vec2 AtexBk;
			varying vec2 VtexBk;
			attribute vec2 AtexFg;
			varying vec2 VtexFg;
			
			void main() {
				gl_Position = vec4( Apos, 0., 1. );
				VtexBk = AtexBk;
				VtexFg = AtexFg;
			}
		`,`
			precision mediump float;
			uniform sampler2D UtexBk;
			varying vec2 VtexBk;	
			uniform sampler2D UtexFg;
			varying vec2 VtexFg;
			
			vec4 accurate_mix ( vec4 bk, vec4 fg ) {
				float alpha = 1.0 - fg.a;
				
//				Gamma correction of 2, close enough to 2.2 or whatever the ideal ratio is.
				vec3 color = sqrt( fg.rgb * fg.rgb + bk.rgb * bk.rgb * alpha );
				
				float out_alpha = fg.a + bk.a * alpha;
				return vec4( color, out_alpha );
			}
			
			void main() {
				vec4 final_color = accurate_mix( texture2D( UtexBk, VtexBk ), texture2D( UtexFg, VtexFg ) );
				gl_FragColor = vec4( final_color.rgb, 1.0 );
			}
		`),i=(H.useProgram(r),H.getAttribLocation(r,"Apos")),a=H.getAttribLocation(r,"AtexBk");var e=H.getUniformLocation(r,"UtexBk");const o=H.getAttribLocation(r,"AtexFg");var t=H.getUniformLocation(r,"UtexFg");H.uniform1i(e,1),H.activeTexture(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Q.tx1),H.uniform1i(t,0);let l,h,d,u;let f=[];const A=H.createBuffer(),n=(this.finishInitTexture=async function(){H.activeTexture(H.TEXTURE1);const t=H.createTexture();H.bindTexture(H.TEXTURE_2D,t),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texImage2D(H.TEXTURE_2D,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,R);let e=0,r=1;for(;(i=H.getError())!==H.NO_ERROR;){console.warn(E(i));var i=document.createElement("canvas"),a=i.getContext("2d"),a=(i.width=R.width>>1,i.height=R.height>>1,console.log("w: "+R.width+", rw: "+i.width+", rh: "+i.height),a.drawImage(R,0,0,i.width,i.height),i.toDataURL());R.src=a;if(await new Promise(e=>{R.onload=()=>{H.bindTexture(H.TEXTURE_2D,t),H.texImage2D(H.TEXTURE_2D,0,H.RGBA,H.RGBA,H.UNSIGNED_BYTE,R),console.log("w: "+R.width+", h: "+R.height),e()}}),r*=2,256<e++)break}l=.5*R.width*r,h=.5*R.height*r,d=Math.min(1,2*k.width/l),u=Math.min(1,2*k.height/h);var o=.5*(1-d)+.1*d,n=.5*(1-u)+.1*u,s=o+d-.2*d,c=n+u-.2*u;f=new Float32Array([s,c,s,n,o,c,o,n]),H.bindBuffer(H.ARRAY_BUFFER,A),H.bufferData(H.ARRAY_BUFFER,f,H.STATIC_DRAW)},H.createBuffer()),s=(H.bindBuffer(H.ARRAY_BUFFER,n),H.bufferData(H.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1]),H.DYNAMIC_DRAW),H.createBuffer()),c=(H.bindBuffer(H.ARRAY_BUFFER,s),H.bufferData(H.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),H.STATIC_DRAW),()=>{var e=f.map((e,t)=>e+(t%2==0?this.x:this.y));H.bindBuffer(H.ARRAY_BUFFER,A),H.bufferSubData(H.ARRAY_BUFFER,0,e,0,8)});this.x=0,this.y=0,this.update=()=>{H.useProgram(r);var e=8e-4*(j-this.x/.1/d),t=8e-4*(J-this.y/.1/u);this.x+=e*z,this.y+=t*z,c(),H.enableVertexAttribArray(i),H.enableVertexAttribArray(a),H.enableVertexAttribArray(o),H.bindBuffer(H.ARRAY_BUFFER,n),H.vertexAttribPointer(i,2,H.FLOAT,!1,0,0),H.bindBuffer(H.ARRAY_BUFFER,A),H.vertexAttribPointer(a,2,H.FLOAT,!1,0,0),H.bindBuffer(H.ARRAY_BUFFER,s),H.vertexAttribPointer(o,2,H.FLOAT,!1,0,0),H.vertexAttribDivisor(i,0),H.vertexAttribDivisor(a,0),H.vertexAttribDivisor(o,0),H.bindFramebuffer(H.FRAMEBUFFER,null),H.drawArrays(H.TRIANGLE_STRIP,0,4),H.disableVertexAttribArray(i),H.disableVertexAttribArray(a),H.disableVertexAttribArray(o)},this.resize=()=>{d=Math.min(1,2*k.width/l),u=Math.min(1,2*k.height/h);var e=.5*(1-d)+.1*d,t=.5*(1-u)+.1*u,r=e+d-.2*d,i=t+u-.2*u;f=new Float32Array([r,i,r,t,e,i,e,t]),H.bindBuffer(H.ARRAY_BUFFER,A),H.bufferData(H.ARRAY_BUFFER,f,H.STATIC_DRAW)},this.reset=()=>{this.x=0,this.y=0}},c=new function(){const t=.6,e=1,r=document.getElementsByClassName("page"),i=document.getElementById("back-arrow"),a=document.getElementsByClassName("disappear-on-focus");let o=null,n=-1,s=null,c=0,l=0,h=0,d=0,u=void 0;const f=()=>{i.onpointerover=void 0,i.onpointerout=void 0,i.onclick=void 0,d=0,u=setTimeout(()=>{i.style.display="none",this.update=()=>{}},500),o.classList.add("fade-out"),o.classList.remove("fade-in"),s=setTimeout(()=>{o.style.display="none";for(const e of a)e.classList.add("fade-in"),e.classList.remove("fade-out"),e.style.display="block";setTimeout(()=>m.resize(k.width,k.height),2)},450),m.deselect(n),k.onclick=g},A=()=>{d=e},R=()=>{d=t},E=(this.show=e=>{-1!==e&&(clearTimeout(u),n===e&&clearTimeout(s),i.style.display="block",i.onpointerover=A,i.onpointerout=R,i.onclick=f,this.update=E,d=t,o=r[e],n=e,s=null,o.style.display="block",o.classList.add("fade-in"),o.classList.remove("fade-out"))},()=>{l=.024*(d-c),h=h+l*z-.08*h,c+=h*z,i.style.opacity=c});this.update=()=>{},this.reset=()=>{d=t,c=t,h=0,l=0}},l=e=>{z=e-i,z/=24,H.bindFramebuffer(H.FRAMEBUFFER,null),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),H.bindFramebuffer(H.FRAMEBUFFER,Q.fb1),H.clear(H.COLOR_BUFFER_BIT),H.bindFramebuffer(H.FRAMEBUFFER,Q.fb2),H.clear(H.COLOR_BUFFER_BIT),m.update(),s.update(),c.update(),window.ontouchmove=h,window.onmousemove=d,o=requestAnimationFrame(l),i=e};t=()=>{var e=k.width,t=k.height;k.width=window.innerWidth,k.height=window.innerHeight,W=k.width/2,q=k.height/2,H.bindFramebuffer(H.FRAMEBUFFER,null),H.viewport(0,0,k.width,k.height),H.clear(H.COLOR_BUFFER_BIT|H.DEPTH_BUFFER_BIT),H.activeTexture(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Q.tx1),H.texImage2D(H.TEXTURE_2D,0,H.RGBA,k.width,k.height,0,H.RGBA,H.UNSIGNED_BYTE,null),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.bindFramebuffer(H.FRAMEBUFFER,Q.fb1),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,Q.tx1,0),H.activeTexture(H.TEXTURE2),H.bindTexture(H.TEXTURE_2D,Q.tx2),H.texImage2D(H.TEXTURE_2D,0,H.RGBA,k.width,k.height,0,H.RGBA,H.UNSIGNED_BYTE,null),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,H.LINEAR),H.bindFramebuffer(H.FRAMEBUFFER,Q.fb2),H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_2D,Q.tx2,0),m.resize(e,t),s.resize()};const h=e=>{console.log("touchmove: ");let t;e.targetTouches&&!(t=_tfind(e.targetTouches,e=>e.identifier===a))||(window.ontouchmove=null,d(t))},d=e=>{window.onmousemove=null,j=e.clientX/W-1,J=-e.clientY/q+1,m.mousemove(e.clientX,k.height-e.clientY)},u=e=>{e.preventDefault(),console.log("mouseout: "),e.targetTouches&&!_tfind(e.targetTouches,e=>e.identifier===a)||(j=0,J=0,window.onpointermove=null,a=null)},f=e=>{cancelAnimationFrame(o),u(e),a=null,j=0,J=0,s.reset(),c.reset(),m.reset(!0)},g=e=>{const t=m.click(e.clientX,k.height-e.clientY);if(setTimeout(()=>{c.show(t)},800),console.log(t),-1!==t){var r=document.getElementsByClassName("disappear-on-focus");for(let t=0;t<r.length;t++){let e=r[t];e.classList.add("fade-out"),e.classList.remove("fade-in"),setTimeout(()=>{e.style.display="none"},450)}k.onclick=void 0}};await s.finishInitTexture(),t(),window.onresize=t,window.onbeforeunload=f,window.onpagehide=f,window.addEventListener("visibilitychange",e=>{"hidden"===document.visibilityState?f(e):o=requestAnimationFrame(l)}),k.onclick=g,window.onmouseleave=u,window.onmouseout=u,window.ontouchstart=e=>{console.log("touchstart: "),null===a&&e.touches&&0<e.touches.length&&(a=e.touches[0].identifier)},window.ontouchend=e=>{console.log("touchend: "),e.targetTouches&&!_tany(e.targetTouches,e=>e.identifier===a)||(a=null)},window.ontouchcancel=e=>{k.ontouchend(e),u(e)};H.getExtension("WEBGL_lose_context");k.addEventListener("webglcontextlost",()=>{}),setTimeout(()=>document.getElementsByClassName("content")[0].classList.add("fade-in"),120),i=performance.now(),o=requestAnimationFrame(l)};window.onload=fn;